<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0">
    <channel>
        <title>Nicolas Perriault</title>
        <link>http://nicolas.perriault.net</link>
        <description>Nicolas Perriault's personal website.</description>
        <language>en-us</language>
        <pubDate>Sun, 04 Mar 2012 19:03:14 +0000</pubDate>
        <lastBuildDate>Sun, 04 Mar 2012 19:03:14 +0000</lastBuildDate>
        
        <item>
            <title>Dead easy yet powerful static website generator with Flask</title>
            <link>http://nicolas.perriault.net/code/2012/dead-easy-yet-powerful-static-website-generator-with-flask</link>
            <description>&lt;p&gt;It&#39;s been a long time I wanted to federate my online identities in a single, managed place — hence the website you&#39;re currently browsing. I&#39;ve also been looking for a static website builder for some times, trying many and retaining zero. It was a bit depressing, frustrating to say the least.&lt;/p&gt;
&lt;p&gt;Then I encountered &lt;a href=&#34;https://twitter.com/#!/mitsuhiko/statuses/166570613295689728&#34;&gt;this tweet by Armin Ronacher&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet tw-align-center&#34;&gt;
    &lt;p&gt;Frozen-Flask is really, really useful. Should have used that earlier.&lt;/p&gt;&amp;mdash; Armin Ronacher (@mitsuhiko) &lt;a href=&#34;https://twitter.com/mitsuhiko/status/166570613295689728&#34; data-datetime=&#34;2012-02-06T17:15:03+00:00&#34;&gt;February 6, 2012&lt;/a&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&#34;http://lucumr.pocoo.org/&#34;&gt;Armin&lt;/a&gt; is the author of &lt;a href=&#34;http://flask.pocoo.org/&#34;&gt;Flask&lt;/a&gt;, a Python microframework I much appreciate for its simplicity, so this tweet immediately rang a bell and I started exploring the possibilities offered by &lt;a href=&#34;http://packages.python.org/Frozen-Flask/&#34;&gt;Frozen-Flask&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Frozen-Flask basically &lt;em&gt;freezes&lt;/em&gt; a Flask application into a set of static files, so you can host it without pain, but with speed. Combined with &lt;a href=&#34;http://packages.python.org/Flask-FlatPages/&#34;&gt;Flask-FlatPages&lt;/a&gt;, you got the perfect set for generating your static website with everyting you could expect by using a framework:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cool uris &amp;amp; easy routing management&lt;/li&gt;
&lt;li&gt;powerful templating&lt;/li&gt;
&lt;li&gt;local, dynamic serving&lt;/li&gt;
&lt;li&gt;static version generation&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;First iteration: project setup&lt;/h2&gt;
&lt;p&gt;Create a brand new &lt;a href=&#34;http://pypi.python.org/pypi/virtualenv&#34;&gt;virtualenv&lt;/a&gt; in a new directory and install the necessary packages using &lt;a href=&#34;http://pypi.python.org/pypi/pip&#34;&gt;pip&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ mkdir sample_project &amp;amp;&amp;amp; cd !$
$ mkvirtualenv --no-site-packages `pwd`/env
$ source env/bin/activate
$ pip install Flask Frozen-Flask Flask-FlatPages
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Write a very first version of our app in a &lt;code&gt;sitebuilder.py&lt;/code&gt; file:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from flask import Flask
app = Flask(__name__)

@app.route(&#34;/&#34;)
def index():
    return &#34;Hello World!&#34;

if __name__ == &#34;__main__&#34;:
    app.run(port=8000)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Run it; you should see someting like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ python sitebuilder.py
 * Running on http://127.0.0.1:8000/
 * Restarting with reloader
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ensure with your browser that everyting is going fine by heading at &lt;code&gt;http://127.0.0.1:8000/&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;New iteration: adding &lt;em&gt;flat pages&lt;/em&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://packages.python.org/Flask-FlatPages/&#34;&gt;Flask-FlatPages&lt;/a&gt; provides a collection of pages to your Flask application. Pages are built from &lt;em&gt;flat&lt;/em&gt; text files as opposed to a relational database.&lt;/p&gt;
&lt;p&gt;Create a &lt;code&gt;pages/&lt;/code&gt; directory at the root of your project folder, and put a &lt;code&gt;hello-world.md&lt;/code&gt; file in there:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ mkdir pages
$ vi pages/hello-world.md
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The &lt;code&gt;pages/hello-world.md&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;unpretty&#34;&gt;&lt;code&gt;title: Hello World
date: 2012-03-04

**Hello World**, from a *page*!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see, we can write plain &lt;a href=&#34;daringfireball.net/projects/markdown/&#34;&gt;Mardown&lt;/a&gt; for our page contents. So let&#39;s rewrite our app to serve any flatpage by its filename:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from flask import Flask
from flaskext.flatpages import FlatPages

DEBUG = True
FLATPAGES_AUTO_RELOAD = DEBUG
FLATPAGES_EXTENSION = &#39;.md&#39;

app = Flask(__name__)
app.config.from_object(__name__)
pages = FlatPages(app)

@app.route(&#39;/&#39;)
def index():
    return &#34;Hello World&#34;

@app.route(&#39;/&amp;lt;path:path&amp;gt;/&#39;)
def page(path):
    return pages.get_or_404(path).html

if __name__ == &#39;__main__&#39;:
    app.run(port=8000)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now requesting &lt;code&gt;http://127.0.0.1:8000/hello-world/&lt;/code&gt; will display our flatpage. Note that the markdown source is converted to html by getting the &lt;code&gt;html&lt;/code&gt; property of our page object.&lt;/p&gt;
&lt;h2&gt;New iteration: adding templates&lt;/h2&gt;
&lt;p&gt;Flask uses the &lt;a href=&#34;http://jinja.pocoo.org/docs/&#34;&gt;Jinja2&lt;/a&gt; template engine, so let&#39;s create some templates to decorate our pages. First create a &lt;code&gt;templates&lt;/code&gt; directory at the root of the project:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ mkdir templates
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create a base layout in &lt;code&gt;templates/base.html&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!doctype html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&#34;utf-8&#34;&amp;gt;
    &amp;lt;title&amp;gt;My site&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;h1&amp;gt;&amp;lt;a href=&#34;{{ url_for(&#34;index&#34;) }}&#34;&amp;gt;My site&amp;lt;/a&amp;gt;&amp;lt;/h1&amp;gt;
{% block content %}
    &amp;lt;p&amp;gt;Default content to be displayed&amp;lt;/p&amp;gt;
{% endblock content %}
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note the use of the &lt;code&gt;url_for()&lt;/code&gt; template helper, that&#39;s the way we generate urls using Flask and Jinja2.&lt;/p&gt;
&lt;p&gt;Now the &lt;code&gt;page.html&lt;/code&gt; template to fill this layout with page contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% extends &#34;base.html&#34; %}

{% block content %}
    &amp;lt;h2&amp;gt;{{ page.title }}&amp;lt;/h2&amp;gt;
    {{ page.html|safe }}
{% endblock content %}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Our app is now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from flask import Flask, render_template
from flaskext.flatpages import FlatPages

DEBUG = True
FLATPAGES_AUTO_RELOAD = DEBUG
FLATPAGES_EXTENSION = &#39;.md&#39;

app = Flask(__name__)
app.config.from_object(__name__)
pages = FlatPages(app)

@app.route(&#39;/&#39;)
def index():
    return &#34;Hello World&#34;

@app.route(&#39;/&amp;lt;path:path&amp;gt;/&#39;)
def page(path):
    page = pages.get_or_404(path)
    return render_template(&#39;page.html&#39;, page=page)

if __name__ == &#39;__main__&#39;:
    app.run(port=8000)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Hell, what did we just do?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;we created templates for our app; a common layout (&lt;code&gt;base.html&lt;/code&gt;) and a page template (&lt;code&gt;page.html&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;we used the &lt;code&gt;render_template&lt;/code&gt; function to use the page template for decorating our pages&lt;/li&gt;
&lt;li&gt;the page template extends the base one to avoid copying and pasting stuff for every page on Earth&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;New iteration: display the list of available pages on the homepage&lt;/h2&gt;
&lt;p&gt;For now our homepage has been a bit sick, to say the least. Let&#39;s make it an index of all available pages.&lt;/p&gt;
&lt;p&gt;Create a &lt;code&gt;templates/index.html&lt;/code&gt; with the following contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% extends &#34;base.html&#34; %}

{% block content %}
    &amp;lt;h2&amp;gt;List of stuff&amp;lt;/h2&amp;gt;
    &amp;lt;ul&amp;gt;
    {% for page in pages %}
        &amp;lt;li&amp;gt;
            &amp;lt;a href=&#34;{{ url_for(&#34;page&#34;, path=page.path) }}&#34;&amp;gt;{{ page.title }}&amp;lt;/a&amp;gt;
        &amp;lt;/li&amp;gt;
    {% else %}
        &amp;lt;li&amp;gt;No stuff.&amp;lt;/li&amp;gt;
    {% endfor %}
    &amp;lt;/ul&amp;gt;
{% endblock content %}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Feel free to create more flat pages, the same way we did with &lt;code&gt;hello-world.md&lt;/code&gt;, storing the file into the &lt;code&gt;pages/&lt;/code&gt; directory using the &lt;code&gt;.md&lt;/code&gt; extension.&lt;/p&gt;
&lt;p&gt;So the &lt;code&gt;index()&lt;/code&gt; route of our app is now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@app.route(&#39;/&#39;)
def index():
    return render_template(&#39;index.html&#39;, pages=pages)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you reload the homepage, a list of all available flatpages is displayed with a link for each. Damn, that was pretty easy.&lt;/p&gt;
&lt;h2&gt;New iteration: adding metadata to pages&lt;/h2&gt;
&lt;p&gt;Flask-FlatPages allows to enter metadata for pages the same way we did for the title and the creation date with our &lt;code&gt;hello-world.md&lt;/code&gt;, and access them using the &lt;code&gt;page.meta&lt;/code&gt; property, which contains a plain silly python dict. That&#39;s pretty awesome when you think about it, heh?&lt;/p&gt;
&lt;p&gt;So let&#39;s imagine you want tags for your pages, our &lt;code&gt;hello-world.md&lt;/code&gt; becomes:&lt;/p&gt;
&lt;pre class=&#34;unpretty&#34;&gt;&lt;code&gt;title: Hello World
date: 2012-03-04
tags: [general, awesome, stuff]

**Hello World**, from a *page*!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For the records, metadata are described in &lt;a href=&#34;http://yaml.org/&#34;&gt;YAML&lt;/a&gt;, so you can use strings, booleans, integers, floats, lists and even dicts which will be converted to their respective native Python equivalent.&lt;/p&gt;
&lt;p&gt;We&#39;re going to use two different templates for listing general pages and tagged ones, using a shared template partial. Our &lt;code&gt;index.html&lt;/code&gt; is now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% extends &#34;base.html&#34; %}

{% block content %}
    &amp;lt;h2&amp;gt;List of stuff&amp;lt;/h2&amp;gt;
    {% with pages=pages  %}
        {% include &#34;_list.html&#34; %}
    {% endwith %}
{% endblock content %}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create a new &lt;code&gt;tag.html&lt;/code&gt; template, which will display the list of tagged pages:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;{% extends &#34;base.html&#34; %}

{% block content %}
    &amp;lt;h2&amp;gt;List of stuff tagged &amp;lt;em&amp;gt;{{ tag }}&amp;lt;/em&amp;gt;&amp;lt;/h2&amp;gt;
    {% with pages=pages  %}
        {% include &#34;_list.html&#34; %}
    {% endwith %}
{% endblock content %}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The new &lt;code&gt;_list.html&lt;/code&gt; template we need for inclusion contains:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;ul&amp;gt;
{% for page in pages %}
    &amp;lt;li&amp;gt;
        &amp;lt;a href=&#34;{{ url_for(&#34;page&#34;, path=page.path) }}&#34;&amp;gt;{{ page.title }}&amp;lt;/a&amp;gt;
    {% if page.meta.tags|length %}
        | Tagged:
        {% for page_tag in page.meta.tags %}
            &amp;lt;a href=&#34;{{ url_for(&#34;tag&#34;, tag=page_tag) }}&#34;&amp;gt;{{ page_tag }}&amp;lt;/a&amp;gt;
        {% endfor %}
    {% endif %}
    &amp;lt;/li&amp;gt;
{% else %}
    &amp;lt;li&amp;gt;No page.&amp;lt;/li&amp;gt;
{% endfor %}
&amp;lt;/ul&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let&#39;s add a new &lt;code&gt;tag&lt;/code&gt; route to our app, to use our new &lt;code&gt;tag.html&lt;/code&gt; template:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;@app.route(&#39;/tag/&amp;lt;string:tag&amp;gt;/&#39;)
def tag(tag):
    tagged = [p for p in pages if tag in p.meta.get(&#39;tags&#39;, [])]
    return render_template(&#39;tag.html&#39;, pages=tagged, tag=tag)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; if you didn&#39;t like Python&#39;s &lt;a href=&#34;http://www.network-theory.co.uk/docs/pytut/ListComprehensions.html&#34;&gt;list comprehensions&lt;/a&gt; yet, now you do.&lt;/p&gt;
&lt;h2&gt;New iteration: generate the static stuff&lt;/h2&gt;
&lt;p&gt;Well, for now we only have a dynamic website, which uses and serves flatpages stored on the filesystem: CRAP. But the idea&#39;s of course not to host a Flask app but a set of static files and assets to skip the need of any application server.&lt;/p&gt;
&lt;p&gt;Here enters Frozen-Flask. Its use is damn easy:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import sys

from flask import Flask, render_template
from flaskext.flatpages import FlatPages
from flask_frozen import Freezer

DEBUG = True
FLATPAGES_AUTO_RELOAD = DEBUG
FLATPAGES_EXTENSION = &#39;.md&#39;

app = Flask(__name__)
app.config.from_object(__name__)
pages = FlatPages(app)
freezer = Freezer(app)

@app.route(&#39;/&#39;)
def index():
    return render_template(&#39;index.html&#39;, pages=pages)

@app.route(&#39;/tag/&amp;lt;string:tag&amp;gt;/&#39;)
def tag(tag):
    tagged = [p for p in pages if tag in p.meta.get(&#39;tags&#39;, [])]
    return render_template(&#39;tag.html&#39;, pages=tagged, tag=tag)

@app.route(&#39;/&amp;lt;path:path&amp;gt;/&#39;)
def page(path):
    page = pages.get_or_404(path)
    return render_template(&#39;page.html&#39;, page=page)

if __name__ == &#39;__main__&#39;:
    if len(sys.argv) &amp;gt; 1 and sys.argv[1] == &#34;build&#34;:
        freezer.freeze()
    else:
        app.run(port=8000)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ python sitebuilder.py build
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Open the &lt;code&gt;build&lt;/code&gt; folder generated by this command:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ tree
.
├── hello-world
│   └── index.html
├── index.html
└── tag
    ├── awesome
    │   └── index.html
    ├── general
    │   └── index.html
    └── stuff
        └── index.html

5 directories, 5 files
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;MIND: BLOWN.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;You can now deploy the contents of this &lt;code&gt;build&lt;/code&gt; directory to any webserver which&#39;s able to serve static files, and you&#39;re done. With just 34 lines of manually written Python code… not bad heh?&lt;/p&gt;
&lt;p&gt;Of course, our website is pretty crappy right now, but you should be get started to add features on your own, now.&lt;/p&gt;</description>
            <pubDate>Sun, 04 Mar 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/code/2012/dead-easy-yet-powerful-static-website-generator-with-flask</guid>
        </item>
        <item>
            <title>Nouveau site</title>
            <link>http://nicolas.perriault.net/carnet/2012/nouveau-site</link>
            <description>&lt;p&gt;&lt;strong&gt;J&#39;avais envie de fédérer l&#39;ensemble de ma &lt;em&gt;production numérique&lt;/em&gt; au sein d&#39;un seul et même site, c&#39;est donc chose faite si vous lisez ces quelques lignes.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;J&#39;ai essayé de résumer au maximum mes activités principales, du moins celles que je trouve potentiellement dignes d&#39;intérêt pour autrui et sur lesquelles j&#39;ai envie de communiquer publiquement&amp;nbsp;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;le &lt;a href=&#34;/code&#34;&gt;développement Web&lt;/a&gt;, en anglais, où je parlerai de ce qui à trait à la technicité de mon métier&amp;nbsp;;&lt;/li&gt;
&lt;li&gt;la &lt;a href=&#34;/photography&#34;&gt;photographie&lt;/a&gt;, où je publierai les photos que je trouve les plus intéressantes&amp;nbsp;;&lt;/li&gt;
&lt;li&gt;mes &lt;a href=&#34;/talks&#34;&gt;interventions publiques en conférence&lt;/a&gt;, plus à des fins d&#39;archivage personnel que pour faire reluire mon ego&amp;nbsp;;&lt;/li&gt;
&lt;li&gt;pour toutes les autres choses qui me passent par la tête, un &lt;a href=&#34;/carnet&#34;&gt;carnet en français&lt;/a&gt; fera vraisemblablement l&#39;affaire. La preuve.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;La carrosserie&lt;/h2&gt;
&lt;p&gt;Je voulais quelque chose de simple, efficace et épuré au maximum. Le contenu textuel est largement mis en avant, sauf dans le cas des photographies où l&#39;image prime bien évidemment.&lt;/p&gt;
&lt;p&gt;J&#39;ai choisi la police &lt;em&gt;Palatino&lt;/em&gt;, parce qu&#39;elle sied à mon regard et qu&#39;elle est disponible sur la plupart des plateformes, mobile y compris.&lt;/p&gt;
&lt;p&gt;J&#39;ai essayé de faire attention à l&#39;importance de l&#39;espace, de mettre en valeur le vide et le rythme typographique, même si je ne suis pas encore pleinement satisfait du résultat. En même temps, c&#39;est comme ça qu&#39;on apprend.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Note: Je n&#39;ai pas le projet à court terme de rendre ce site compatible avec les caprices du moteur de rendu d&#39;Internet Explorer. J&#39;ose espérer que la version 9 du navigateur ne maltraite pas trop l&#39;affichage, mais d&#39;expérience, rien n&#39;est moins sûr. Peu importe.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Sous le capot&lt;/h2&gt;
&lt;p&gt;Je n&#39;ai utilisé aucun framework CSS, juste quelques styles bien sentis. Et ça fait plutôt pas mal le taf, en restant très léger et maintenable notamment grâce à &lt;a href=&#34;http://lesscss.org/&#34;&gt;LESS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Côté moteur, j&#39;ai développé un petit générateur de site statique sur base &lt;a href=&#34;http://flask.pocoo.org/&#34;&gt;Flask&lt;/a&gt;, un microframework en Python que je vous enjoins à considérer tellement il est efficace et bien documenté. Mais je vous en dirai un peu plus dans un prochain billet technique à paraître prochainement.&lt;/p&gt;
&lt;p&gt;Les billets sont écrits en &lt;a href=&#34;http://daringfireball.net/projects/markdown&#34;&gt;markdown&lt;/a&gt;, une syntaxe simple et limitée (d&#39;aucuns suggéreront que qui se ressemble s&#39;assemble, mais j&#39;emmerde d&#39;aucuns).&lt;/p&gt;
&lt;h2&gt;À venir&lt;/h2&gt;
&lt;p&gt;Il me reste pas mal de photos à importer et quelques redirections permanentes à mettre en place, mais je suis globalement plutôt satisfait du résultat. Surtout, je vais pouvoir me remettre à écrire autre chose que des &lt;a href=&#34;https://twitter.com/n1k0&#34;&gt;&lt;em&gt;tweets&lt;/em&gt;&lt;/a&gt;, et ça c&#39;est plutôt cool.&lt;/p&gt;</description>
            <pubDate>Sat, 03 Mar 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/carnet/2012/nouveau-site</guid>
        </item>
        <item>
            <title>Gandi Standard SSL Certificate &amp; Nginx</title>
            <link>http://nicolas.perriault.net/code/2012/gandi-standard-ssl-certificate-nginx</link>
            <description>&lt;p&gt;&lt;a href=&#34;http://gandi.net/&#34;&gt;Gandi&lt;/a&gt; offers a &lt;a href=&#34;http://wiki.gandi.net/en/ssl/free&#34;&gt;free SSL certificate&lt;/a&gt; during one year for any domain you buy there, nice. But the setup is a bit tedious and the documentation a bit disparate, so here&#39;s an attempt for a comprehensive howto for configuring a secured &lt;a href=&#34;http://nginx.org/&#34;&gt;nginx&lt;/a&gt; vhost using your &lt;em&gt;free&lt;/em&gt; certificate.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; &lt;em&gt;Gandi&#39;s quite complicated email confirmation and validation worflow won&#39;t be covered in this post. Just ensure you can receive emails at &lt;code&gt;admin@domain.tld&lt;/code&gt; where &lt;code&gt;domain.tld&lt;/code&gt; is your domain.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Creating your certificate&lt;/h2&gt;
&lt;p&gt;On your server, ensure you have the &lt;a href=&#34;http://openssl.org/&#34;&gt;&lt;code&gt;openssl&lt;/code&gt;&lt;/a&gt; command available or install it. Then, &lt;a href=&#34;http://wiki.gandi.net/en/ssl/csr&#34;&gt;generate your CSR&lt;/a&gt; (&lt;code&gt;domain.tld&lt;/code&gt; is your actual domain):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ openssl req -nodes -newkey rsa:2048 -keyout domain.tld.key \
    -out domain.tld.csr
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Answer a few questions from the program, but here&#39;s the most important bit: &lt;strong&gt;enter your domain or subdomain when prompted to provide a &lt;em&gt;Common Name&lt;/em&gt;&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Common Name (eg, YOUR name) []: domain.tld
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As they say:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The process will create 2 files: a public &lt;code&gt;.csr&lt;/code&gt; file, and a private &lt;code&gt;.key&lt;/code&gt; file which you must absolutely keep private.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; &lt;em&gt;Alas, you won&#39;t be able to extend your certicate to all possible subdomains using a wildcard as it is &lt;a href=&#34;http://wiki.gandi.net/questions/fr/ssl/csr/multi-domaine-non-accepte&#34;&gt;only supported starting with their &lt;em&gt;«Pro»&lt;/em&gt; offer&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Have a coffee.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2&gt;Enter &lt;del&gt;Sandman&lt;/del&gt; Franz Kafka&lt;/h2&gt;
&lt;p&gt;Next, head to your &lt;a href=&#34;https://www.gandi.net/admin/domain&#34;&gt;Gandi domain management page&lt;/a&gt;, select your domain, click on  &lt;em&gt;SSL Certificate: Manage&lt;/em&gt;, click on &lt;em&gt;Activate this certificate&lt;/em&gt; then Paste the content of the generated &lt;code&gt;domain.tld.csr&lt;/code&gt; file into the textarea and submit the form. Then wait for some email from Gandi to confirm your demand.&lt;/p&gt;
&lt;p&gt;In the meanwhile, &lt;a href=&#34;http://wiki.gandi.net/en/ssl/intermediate&#34;&gt;retrieve the intermediate certificate&lt;/a&gt; from the &lt;a href=&#34;https://www.gandi.net/admin/ssl/manage&#34;&gt;SSL certificate management page&lt;/a&gt; of your Gandi account, clicking on the tiny magnifying glass next to your domain name (the one with a nicely hidden &lt;em&gt;«Get the certificate»&lt;/em&gt; tooltip on rollover); you&#39;ll get both the certificate and &lt;em&gt;Gandi&#39;s operational certificate authority&lt;/em&gt; files:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cert-domain.tld.pem&lt;/code&gt;, where &lt;code&gt;domain.tld&lt;/code&gt; is your actual domain&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GandiStandardSSLCA.pem&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Upload them both to your server, store them in eg. &lt;code&gt;/etc/nginx/certificates/&lt;/code&gt; (nope, this directory is unlikely to exist by default; do as you like).&lt;/p&gt;
&lt;p&gt;Last, you have to append the Gandi CA to your domain certificate:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ cat GandiStandardSSLCA.pem &amp;gt;&amp;gt; cert-domain.tld.crt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Have a capuccino.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2&gt;Configuring the nginx vhost&lt;/h2&gt;
&lt;p&gt;Here&#39;s a sample vhost server configuration for nginx, kept as concise as possible for the sake of brevity and clarity:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server {
    listen 443;
    server_name &#34;domain.tld&#34;;
    root /var/www/your_website_root;

    ssl on;
    ssl_certificate     /etc/nginx/certificates/cert-domain.tld.crt;
    ssl_certificate_key /etc/nginx/certificates/domain.tld.key;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Restart nginx and you should be able to access your website using &lt;code&gt;https://domain.tld/&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To redirect all HTTP trafic to HTTPS for this server, add this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;server {
    listen 80;
    server_name &#34;domain.tld&#34;;
    rewrite ^(.*) https://$host$1 permanent;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Have a latte.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;At this point, you should be seriously considering quitting caffeine. As a positive note, it looks like the whole process will be revamped in &lt;em&gt;some weeks&lt;/em&gt;:&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet tw-align-center&#34; data-in-reply-to=&#34;174864441731588096&#34;&gt;
    &lt;p&gt;@&lt;a href=&#34;https://twitter.com/n1k0&#34;&gt;n1k0&lt;/a&gt; browsers (ff and others) allow us to validate via a DNS entry we will change the workflow in some weeks when we&#39;ll put it in the API.&lt;/p&gt;&amp;mdash; gandi.net (@gandi_net) &lt;a href=&#34;https://twitter.com/gandi_net/status/174909743612166144&#34; data-datetime=&#34;2012-02-29T17:31:47+00:00&#34;&gt;February 29, 2012&lt;/a&gt;
&lt;/blockquote&gt;

&lt;p&gt;If you&#39;re looking for other alternatives than Gandi for getting SSL certs, it seems that many people are speaking well of &lt;a href=&#34;http://www.startssl.com/&#34;&gt;StartSSL&lt;/a&gt; despite their ugly site, but I didn&#39;t use the service myself.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://wiki.gandi.net/en/ssl&#34;&gt;Gandi SSL wiki pages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.informathic.com/post/2010/12/24/installer-ssl-gandi-nginx&#34;&gt;Installer un certificat Gandi SSL Standard sur Nginx&lt;/a&gt; (French)&lt;/li&gt;
&lt;/ul&gt;</description>
            <pubDate>Wed, 29 Feb 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/code/2012/gandi-standard-ssl-certificate-nginx</guid>
        </item>
        <item>
            <title>L’Espiguette</title>
            <link>http://nicolas.perriault.net/photography/2012/espiguette</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2012/espiguette/main.jpg&quot; alt=&quote;L’Espiguette by Nicolas Perriault&quot;&gt;&lt;/p&gt;&lt;p&gt;Plage de l&#39;Espiguette, janvier 2012&lt;/p&gt;&lt;p&gt;Some oldies I never took the time to publish.&lt;/p&gt;</description>
            <pubDate>Wed, 15 Feb 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2012/espiguette</guid>
        </item>
        <item>
            <title>Follow the Black Dog</title>
            <link>http://nicolas.perriault.net/photography/2012/follow-the-black-dog</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2012/follow-the-black-dog/main.jpg&quot; alt=&quote;Follow the Black Dog by Nicolas Perriault&quot;&gt;&lt;/p&gt;&lt;p&gt;White rabbits are overrated.&lt;/p&gt;</description>
            <pubDate>Tue, 14 Feb 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2012/follow-the-black-dog</guid>
        </item>
        <item>
            <title>Communism is Dead</title>
            <link>http://nicolas.perriault.net/photography/2012/communism-is-dead</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2012/communism-is-dead/main.jpg&quot; alt=&quote;Communism is Dead by Nicolas Perriault&quot;&gt;&lt;/p&gt;&lt;p&gt;Signs of the times?&lt;/p&gt;</description>
            <pubDate>Tue, 14 Feb 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2012/communism-is-dead</guid>
        </item>
        <item>
            <title>Mystery Door</title>
            <link>http://nicolas.perriault.net/photography/2012/mystery-door</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2012/mystery-door/main.jpg&quot; alt=&quote;Mystery Door by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sat, 11 Feb 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2012/mystery-door</guid>
        </item>
        <item>
            <title>Presqu’île de Maguelone</title>
            <link>http://nicolas.perriault.net/photography/2012/presqu-ile-de-maguelone</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2012/presqu-ile-de-maguelone/main.jpg&quot; alt=&quote;Presqu’île de Maguelone by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Mon, 02 Jan 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2012/presqu-ile-de-maguelone</guid>
        </item>
        <item>
            <title>Sunset Shooters</title>
            <link>http://nicolas.perriault.net/photography/2012/sunset-shooters</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2012/sunset-shooters/main.jpg&quot; alt=&quote;Sunset Shooters by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sun, 01 Jan 2012 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2012/sunset-shooters</guid>
        </item>
        <item>
            <title>Presqu&#39;île de Maguelone</title>
            <link>http://nicolas.perriault.net/photography/2011/presqu-ile-de-maguelone</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/presqu-ile-de-maguelone/main.jpg&quot; alt=&quote;Presqu&#39;île de Maguelone by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Fri, 30 Dec 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/presqu-ile-de-maguelone</guid>
        </item>
        <item>
            <title>Thau</title>
            <link>http://nicolas.perriault.net/photography/2011/thau</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/thau/main.jpg&quot; alt=&quote;Thau by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Mon, 12 Dec 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/thau</guid>
        </item>
        <item>
            <title>Reflections</title>
            <link>http://nicolas.perriault.net/photography/2011/reflections</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/reflections/main.jpg&quot; alt=&quote;Reflections by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Mon, 05 Dec 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/reflections</guid>
        </item>
        <item>
            <title>Moving on</title>
            <link>http://nicolas.perriault.net/photography/2011/moving-on</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/moving-on/main.jpg&quot; alt=&quote;Moving on by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Fri, 02 Dec 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/moving-on</guid>
        </item>
        <item>
            <title>Blur</title>
            <link>http://nicolas.perriault.net/photography/2011/blur</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/blur/main.jpg&quot; alt=&quote;Blur by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sat, 26 Nov 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/blur</guid>
        </item>
        <item>
            <title>Saint-Guilhem le Desert</title>
            <link>http://nicolas.perriault.net/photography/2011/saint-guilhem-le-desert</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/saint-guilhem-le-desert/main.jpg&quot; alt=&quote;Saint-Guilhem le Desert by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sat, 26 Nov 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/saint-guilhem-le-desert</guid>
        </item>
        <item>
            <title>Reading Desk</title>
            <link>http://nicolas.perriault.net/photography/2011/reading-desk</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/reading-desk/main.jpg&quot; alt=&quote;Reading Desk by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sat, 26 Nov 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/reading-desk</guid>
        </item>
        <item>
            <title>Setup Jenkins for working with a private Github repository</title>
            <link>http://nicolas.perriault.net/code/2011/setup-jenkins-github-private-repository-ubuntu</link>
            <description>&lt;p&gt;As I&#39;ve just lost an hour and some hairs dealing with trying to setup a &lt;a href=&#34;http://jenkins-ci.org/&#34;&gt;Jenkins&lt;/a&gt; project connected to a private repository hosted on &lt;a href=&#34;https://github.com/&#34;&gt;Github&lt;/a&gt;, I thought it&#39;s worth a quick blog post. I&#39;m using &lt;a href=&#34;http://ubuntu.com/&#34;&gt;Ubuntu&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So first &lt;code&gt;su&lt;/code&gt; as the &lt;code&gt;jenkins&lt;/code&gt; user to create some SSH keypair:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ssh-keygen -p
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice the &lt;code&gt;-p&lt;/code&gt; option; this will allow to avoid asking for a passphrase (which Jenkins cannot so running as a daemon).&lt;/p&gt;
&lt;p&gt;Try to ssh on github:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ ssh -T git@github.com
The authenticity of host &#39;github.com (207.97.227.239)&#39; can&#39;t be established.
RSA key fingerprint is 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48.
Are you sure you want to continue connecting (yes/no)? yes
Hi username/reponame! You&#39;ve successfully authenticated, but GitHub does not provide shell access.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice that you&#39;re asked to allow github&#39;s hostname to be added to your &lt;code&gt;known_hosts&lt;/code&gt; file: without completing this step, you&#39;re doomed.&lt;/p&gt;
&lt;p&gt;Now, in the Jenkins project configuration interface, set the private repository url using the &lt;code&gt;git&lt;/code&gt; protocol, eg. &lt;code&gt;git@github.com:username/reponame.git&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;That&#39;s it, Jenkins will be able to clone and use your private repo.&lt;/p&gt;
&lt;p&gt;If you know a better way, &lt;a href=&#34;/contact/&#34;&gt;I&#39;m all ears&lt;/a&gt;.&lt;/p&gt;</description>
            <pubDate>Wed, 16 Nov 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/code/2011/setup-jenkins-github-private-repository-ubuntu</guid>
        </item>
        <item>
            <title>Dolce Vita</title>
            <link>http://nicolas.perriault.net/photography/2011/dolce-vita</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/dolce-vita/main.jpg&quot; alt=&quote;Dolce Vita by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sat, 29 Oct 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/dolce-vita</guid>
        </item>
        <item>
            <title>Scrape and test any webpage using PhantomJS</title>
            <link>http://nicolas.perriault.net/code/2011/scrape-and-test-any-webpage-using-phantomjs</link>
            <description>&lt;p&gt;Have you ever tried to scrape or harvest data from an existing website —
I mean, even ajax-bloated ones? Did you ever attempt to test
javascript-dependent interactions within a Web application you built?
Well, if you answered yes to one of the questions above, you might be
interested in &lt;a href=&#34;http://phantomjs.org/&#34;&gt;PhantomJS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;PhantomJS is a &lt;em&gt;headless WebKit with JavaScript API&lt;/em&gt;. By headless, they
mean you can script a real &lt;a href=&#34;http://webkit.org/&#34;&gt;Webkit&lt;/a&gt; based browser
with no need for a full graphical interface installed.&lt;/p&gt;
&lt;h3&gt;Installation&lt;/h3&gt;
&lt;p&gt;On OSX, installation can be achieved using
&lt;a href=&#34;https://github.com/mxcl/homebrew&#34;&gt;homebrew&lt;/a&gt; (note that
&lt;a href=&#34;static/itunes.apple.com/fr/app/xcode/id448457090?mt=12&#34;&gt;XCode&lt;/a&gt; must be
installed on your machine):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ brew install phantomjs
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It can take a bit of time for the binaries to be built, especially
because of their dependency to &lt;a href=&#34;static/qt.nokia.com/products&#34;&gt;Qt4&lt;/a&gt;. When
it&#39;s done, you can test it this way:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ phantomjs
Usage: phantomjs [options] script.[js|coffee] [script argument [script argument ...]]
Options:
    --load-images=[yes|no]             Load all inlined images (default is &#39;yes&#39;).
    --load-plugins=[yes|no]            Load all plugins (i.e. &#39;Flash&#39;, &#39;Silverlight&#39;, ...) (default is &#39;no&#39;).
    --proxy=address:port               Set the network proxy.
    --disk-cache=[yes|no]              Enable disk cache (at desktop services cache storage location, default is &#39;no&#39;).
    --ignore-ssl-errors=[yes|no]       Ignore SSL errors (i.e. expired or self-signed certificate errors).
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Installation instructions for other platforms and alternative methods
can be found on &lt;a href=&#34;http://code.google.com/p/phantomjs/wiki/Installation&#34;&gt;the PhantomJS project
wiki&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As a side note, there&#39;s also a Python implementation of PhantomJS,
&lt;a href=&#34;http://dev.umaclan.com/projects/pyphantomjs&#34;&gt;PyPhantomJS&lt;/a&gt;, which adds
&lt;a href=&#34;http://dev.umaclan.com/projects/pyphantomjs/wiki/Plugins&#34;&gt;plugins&lt;/a&gt;
support! Also, I&#39;ve found myself having no segfault using the Python
version while the standard one is a bit more unstable on my box (no
troll please).&lt;/p&gt;
&lt;p&gt;To install PyPhantomJS, let&#39;s use
&lt;a href=&#34;http://www.pip-installer.org/&#34;&gt;&lt;code&gt;pip&lt;/code&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ pip install PyPhantomJS
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The PyPhantomJS executable is named — &lt;em&gt;surprise&lt;/em&gt; — &lt;code&gt;pyphantomjs&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ pyphantomjs
usage: pyphantomjs [options] script.[js|coffee] [script argument [script argument ...]]
Minimalistic headless WebKit-based JavaScript-driven tool
positional arguments:
  script.[js|coffee]    The script to execute, and any args to pass to it
optional arguments:
  -h, --help            show this help message and exit
  --disk-cache {yes,no}
                        Enable disk cache (default: no)
  --ignore-ssl-errors {yes,no}
                        Ignore SSL errors (default: no)
  --load-images {yes,no}
                        Load all inlined images (default: yes)
  --load-plugins {yes,no}
                        Load all plugins (i.e. Flash, Silverlight, ...) (default: no)
  --proxy address:port  Set the network proxy
  -v, --verbose         Show verbose debug messages
  --version             show this program&#39;s version and license
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Usage of the two versions is exactly the same.&lt;/p&gt;
&lt;h3&gt;Basic usage&lt;/h3&gt;
&lt;p&gt;PhantomJS scripts can be written in standard JavaScript or in
&lt;a href=&#34;http://jashkenas.github.com/coffee-script/&#34;&gt;CoffeeScript&lt;/a&gt;. Mainly
matter of taste here, but CoffeeScript syntax &lt;a href=&#34;http://robots.thoughtbot.com/post/9251081564/coffeescript-spartan-javascript&#34;&gt;looks really
interesting&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So let&#39;s write our first script, we want to retrieve the weather
forecast for a given city using Google:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// script: meteo.js
var page = new WebPage()
, output = { errors: [], results: null };
if (phantom.args.length == 0) {
    console.log(&#39;You must specify a city, eg. &#34;Paris, France&#34;&#39;);
    phantom.exit(1);
}
page.open(&#39;http://www.google.fr/search?q=meteo+&#39; + phantom.args[0], function (status) {
    if (status !== &#39;success&#39;) {
        output.errors.push(&#39;Unable to access network&#39;);
    } else {
        var cells = page.evaluate(function(){
            try {
                var cells = document.querySelectorAll(&#39;.tpo tr tr&#39;)[4].querySelectorAll(&#39;td&#39;);
                return Array.prototype.map.call(cells, function(cell) {
                    return cell.innerText.replace(/[^0-9]/g, &#39;&#39;);
                });
            } catch (e) {
                return [];
            }
        });
        if (!cells || !cells.length &amp;gt; 0) {
            output.errors.push(&#39;No valid meteo data found&#39;);
        } else {
            output.results = {
                city: phantom.args[0],
                today: {
                    afternoon: cells[1],
                    morning:   cells[2],
                },
                tomorrow: {
                    afternoon: cells[3],
                    morning:   cells[4],
                }
            };
        }
        console.log(JSON.stringify(output, null, &#39;    &#39;));
    }
    phantom.exit();
});
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Notice we use the &lt;code&gt;phantom.args&lt;/code&gt; Array which contains the parameters
passed to the script.&lt;/p&gt;
&lt;p&gt;The main magic happens in the &lt;code&gt;page.evaluate()&lt;/code&gt; method, we pass it a
JavaScript function which will be evaluated &lt;strong&gt;within the retrieved page
document environment&lt;/strong&gt;. It&#39;s a kind of &lt;em&gt;non-persistent XSS injection&lt;/em&gt;
just to help you to operate on the page contents =)&lt;/p&gt;
&lt;p&gt;Now it&#39;s time to launch the script to see how it goes:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ phantomjs meteo.js &#34;Montpellier, France&#34;
{
    &#34;errors&#34;: [],
    &#34;results&#34;: {
        &#34;city&#34;: &#34;Montpellier, France&#34;,
        &#34;today&#34;: {
            &#34;afternoon&#34;: &#34;29&#34;,
            &#34;morning&#34;: &#34;17&#34;
        },
        &#34;tomorrow&#34;: {
            &#34;afternoon&#34;: &#34;28&#34;,
            &#34;morning&#34;: &#34;17&#34;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now with an invalid city name:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ phantomjs meteo.js &#34;Unexistent City&#34;
{
    &#34;errors&#34;: [
        &#34;No valid meteo data found&#34;
    ],
    &#34;results&#34;: null
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let&#39;s try with another city, an existing one this time:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;$ phantomjs meteo.js &#34;Paris, France&#34;
{
    &#34;errors&#34;: [],
    &#34;results&#34;: {
        &#34;city&#34;: &#34;Paris, France&#34;,
        &#34;today&#34;: {
            &#34;afternoon&#34;: &#34;21&#34;,
            &#34;morning&#34;: &#34;11&#34;
        },
        &#34;tomorrow&#34;: {
            &#34;afternoon&#34;: &#34;21&#34;,
            &#34;morning&#34;: &#34;11&#34;
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As a side note and in case you were wondering, you now understand a bit
more why I moved to Montpellier ;)&lt;/p&gt;
&lt;h3&gt;I CAN HAZ SCREENSHOTS&lt;/h3&gt;
&lt;p&gt;PhantomJS also allows some nice tricks like injecting scripts to the
remote page, very useful when a remote website doesn&#39;t ship with your
favorite framework (eg. &lt;a href=&#34;http://jquery.com/&#34;&gt;jQuery&lt;/a&gt;)… or can render a
PNG image of a captured area of the webpage. The example below saves a
capture of the weather forecast area:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;// script: meteoclip.js
var page = new WebPage();
page.open(&#39;http://www.google.fr/search?q=meteo+montpellier,+France&#39;, function (status) {
    if (status !== &#39;success&#39;) {
        output.error = &#39;Unable to access network&#39;;
    } else {
        page.clipRect = {
            top: 127,
            left: 170,
            width: 400,
            height: 114
        }
        page.render(&#39;meteo.png&#39;);
        console.log(&#39;Capture saved&#39;);
    }
    phantom.exit();
});
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Running the &lt;code&gt;meteoclip.js&lt;/code&gt; script will get yourself this fancy image
stored in &lt;code&gt;meteo.jpg&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;image&#34; src=&#34;http://cl.ly/0w2a050b3x2g170u053A/meteo.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;There are tons of other cool topics to cover about PhantomJS, like
navigation handling, automated logging in, external resources
retrieving, functional testing, code organization… so I&#39;ll maybe post a
bit more about it soon, who knows!&lt;/p&gt;</description>
            <pubDate>Sat, 27 Aug 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/code/2011/scrape-and-test-any-webpage-using-phantomjs</guid>
        </item>
        <item>
            <title>Beach Boy</title>
            <link>http://nicolas.perriault.net/photography/2011/beach-boy</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/beach-boy/main.jpg&quot; alt=&quote;Beach Boy by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Wed, 10 Aug 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/beach-boy</guid>
        </item>
        <item>
            <title>Cairn</title>
            <link>http://nicolas.perriault.net/photography/2011/cairn</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/cairn/main.jpg&quot; alt=&quote;Cairn by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Tue, 02 Aug 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/cairn</guid>
        </item>
        <item>
            <title>The Sheriff</title>
            <link>http://nicolas.perriault.net/photography/2011/the-sheriff</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/the-sheriff/main.jpg&quot; alt=&quote;The Sheriff by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Fri, 29 Jul 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/the-sheriff</guid>
        </item>
        <item>
            <title>Path</title>
            <link>http://nicolas.perriault.net/photography/2011/path</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/path/main.jpg&quot; alt=&quote;Path by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Tue, 26 Jul 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/path</guid>
        </item>
        <item>
            <title>Bulls Raid</title>
            <link>http://nicolas.perriault.net/photography/2011/bulls-raid</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/bulls-raid/main.jpg&quot; alt=&quote;Bulls Raid by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Sun, 12 Jun 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/bulls-raid</guid>
        </item>
        <item>
            <title>Walkers on the Moon</title>
            <link>http://nicolas.perriault.net/photography/2011/walkers-on-the-moon</link>
            <description>&lt;p&gt;&lt;img src=&quot;/static/photography/2011/walkers-on-the-moon/main.jpg&quot; alt=&quote;Walkers on the Moon by Nicolas Perriault&quot;&gt;&lt;/p&gt;</description>
            <pubDate>Fri, 22 Apr 2011 00:00:00 +0000</pubDate>
            <guid>http://nicolas.perriault.net/photography/2011/walkers-on-the-moon</guid>
        </item>
        
    </channel>
</rss>